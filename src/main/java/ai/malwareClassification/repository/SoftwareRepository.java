package ai.malwareClassification.repository;

import ai.malwareClassification.domain.Software;
import ai.malwareClassification.domain.SoftwareBehavior;
import ai.malwareClassification.domain.SoftwarePurpose;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;

import java.util.List;
import java.util.Optional;

public interface SoftwareRepository {

    Optional<Software> findById(long id);
    Optional<Software> findBySignature(String signature);
    Software save(Software software);
    List<SoftwarePurpose> purposesFindBySoftwareId(Long id);

    List<SoftwareBehavior> behaviorsFindBySoftwareId(Long id);

    SoftwarePurpose save(SoftwarePurpose softwarePurpose);

    SoftwareBehavior save(SoftwareBehavior softwareBehavior);

    Optional<SoftwarePurpose> purposeFindById(Long id);

    Optional<SoftwareBehavior> behaviorFindById(Long id);

    Page<Software> findAll(Pageable pageable);

    Page<Software> findAllBySearch(Pageable pageable, String searchText, String searchBy);

    void updateNickname(Long id, String newNickname);

    void deleteSignature(Long id);

}
