import { joinValidator } from './joinValidator.js';

const $joinForm = document.getElementById('joinForm')

const highlightError = ($input, errorMessage) => {
    $input.classList.add("is-invalid")
    $input.nextElementSibling.innerText = errorMessage
}

const clearError = ($input) => {
    $input.classList.remove("is-invalid")
    $input.nextElementSibling.innerText = ""
}

const validate = () => {
    const $usernameInput = document.getElementById('username')
    const $passwordInput = document.getElementById('password')
    const $employeeIdInput = document.getElementById('employeeId')
    const $departmentInput = document.getElementById('department')
    const $roleInput = document.getElementById('role')

    const usernameValue = $usernameInput.value
    const passwordValue = $passwordInput.value
    const employeeIdValue = $employeeIdInput.value
    const departmentValue = $departmentInput.value
    const roleValue = $roleInput.value

    clearError($usernameInput)
    clearError($passwordInput)
    clearError($departmentInput)
    clearError($roleInput)

    const validator = new joinValidator()

    let errorCount = 0

    if (!validator.validateUsername(usernameValue)) {
        highlightError($usernameInput, '알파벳, 숫자로만 4 ~ 32자로 입력하세요.')
        errorCount += 1
    }

    if (!isUniqueName && errorCount === 0) {
        highlightError($usernameInput, '중복검사를 해주세요')
        errorCount += 1
    }

    if (!validator.validatePassword(passwordValue)) {
        highlightError($passwordInput, '알파벳, 숫자로만 3자이상 입력하세요.')
        errorCount += 1
    }

    if (!employeeIdValue) {
        highlightError($employeeIdInput, '사원번호를 입력해주세요.')
        errorCount += 1
    }

    if (!departmentValue) {
        highlightError($departmentInput, '골라주세요.')
        errorCount += 1
    }

    if (!roleValue) {
        highlightError($roleInput, '골라주세요.')
        errorCount += 1
    }

    console.log(errorCount)

    return (errorCount ? false : true)
}

$joinForm.addEventListener('submit', (event) => {
    debugger
    if (!validate()) {
        event.preventDefault()
    }
})