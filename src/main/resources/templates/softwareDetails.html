<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:replace="/fragments/header.html :: fragment-header"></div>
</head>
<body>
    <div class="container">
        <div th:replace="/fragments/navbar.html :: fragment-navbar"></div>
        <div>
            <table class="table table-secondary table-bordered">
                <tbody>
                    <tr>
                        <th>시그니처:</th>
                        <td th:text="${softwareDetailsDto.signature}"></td>
                    </tr>
                    <tr>
                        <th>파일이름:</th>
                        <td><a th:text="${softwareDetailsDto.filename}" th:href="@{/software/{id}/download(id=${softwareDetailsDto.id})}">파일 다운로드</a></td>
                    </tr>
                    <tr>
                        <th>업로드 날짜:</th>
                        <td th:text="${#temporals.format(softwareDetailsDto.createdTime, 'yyyy-MM-dd HH:mm:SS')}"></td>
                    </tr>
                    <tr>
                        <th>업로더:</th>
                        <td th:text="${softwareDetailsDto.uploaderName}"></td>
                    </tr>
                    <tr>
                        <th>닉네임:</th>
                        <td th:text="${softwareDetailsDto.nickname}"></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <br>

        <br>
        <div>
            <form class="d-flex" th:action="@{|/software/${softwareDetailsDto.id}|}" th:method="DELETE" th:if="${softwareDetailsDto.uploaderId}==${loginUserId}">
                <input class="form-control me-2" type="hidden" aria-label="id" name="id" th:value="${softwareDetailsDto.id}">
                <button class="btn btn-outline-success" type="submit">시그니처삭제</button>
            </form>
        </div>
        <br>



        <div class="bg-light">
            <div class="py-5 text-center">
                <h2>보고서 리스트</h2>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>id</th>
                        <th>title</th>
                        <th>uploader</th>
                        <th>filename</th>
                        <th>createdTime</th>
                        <th>modifiedTime</th>
                    </tr>
                <thead>
                <tbody>
                    <tr th:each="report: ${softwareDetailsDto.reportDtoList}">
                        <td th:text="${report.id}"></td>
                        <td><a th:text="${report.title}" th:href="@{|/software/${softwareDetailsDto.id}/report/${report.id}|}" /></td>
                        <td th:text="${report.uploader}"></td>
                        <td th:text="${report.filename}"></td>
                        <td th:text="${#temporals.format(report.createdTime, 'yyyy-MM-dd HH:mm:SS')}"></td>
                        <td th:text="${#temporals.format(report.modifiedTime, 'yyyy-MM-dd HH:mm:SS')}"></td>
                    </tr>
                </tbody>
            </table>

            <!-- pagination bar -->
            <div th:if="${softwareDetailsDto.pageableCustom.totalPages > 1}">
                <ul class="pagination justify-content-center">

                    <li class="page-item">
                        <a class="page-link" th:href="@{|?page=${softwareDetailsDto.pageableCustom.page-1}|}" th:classappend="${!softwareDetailsDto.pageableCustom.hasPrevious} ? 'disabled'">
                            <span>이전</span>
                        </a>
                    </li>

                    <li th:each="page: ${#numbers.sequence(1, softwareDetailsDto.pageableCustom.totalPages)}"
                        th:if="${page >= softwareDetailsDto.pageableCustom.page-5 and page <= softwareDetailsDto.pageableCustom.page+5}"
                        th:classappend="${page == softwareDetailsDto.pageableCustom.page} ? 'active'"
                        class="page-item">
                        <a th:text="${page}" class="page-link" th:href="@{|?page=${page}|}" th:classappend="${page == softwareDetailsDto.pageableCustom.page} ? 'disabled'"></a>
                    </li>

                    <li class="page-item">
                        <a class="page-link" th:href="@{|?page=${softwareDetailsDto.pageableCustom.page+1}|}" th:classappend="${!softwareDetailsDto.pageableCustom.hasNext} ? 'disabled'">
                            <span>다음</span>
                        </a>
                    </li>

                </ul>
            </div>
        </div>


        <br>
        <button class="btn btn-outline-success" th:onclick="|location.href='@{|/analyze/model1/${softwareDetailsDto.id}|}'|">api 리포트</button>
        <button class="btn btn-outline-success" th:onclick="|location.href='@{|/software/${softwareDetailsDto.id}/report-post|}'|">리포트 기재</button>
    </div>
</body>
</html>