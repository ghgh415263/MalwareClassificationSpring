<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <div>
        <ol class="list-group list-group-numbered">
            <li th:text="@{|Signature: ${softwareAndReportDTO.signature}|}" class="list-group-item"></li>
            <li th:text="@{|발견시 파일 이름: ${softwareAndReportDTO.first_name}|}" class="list-group-item"></li>
            <li th:text="@{|업로더 이름: ${softwareAndReportDTO.uploader_name}|}" class="list-group-item"></li>
            <li th:text="@{|업로드 날짜: ${softwareAndReportDTO.find_datetime}|}" class="list-group-item"></li>
            <li th:text="@{|닉네임: ${softwareAndReportDTO.nickname}|}" class="list-group-item"></li>
        </ol>
    </div>
    <br>
    <div>
        <form class="d-flex" th:action="@{|/software/${softwareAndReportDTO.id}|}" th:method="PATCH">
            <input class="form-control me-2" type="newNickname" aria-label="newNickname" name="newNickname">
            <button class="btn btn-outline-success" id="button-addon2" type="submit">닉네임바꾸기</button>
        </form>
    </div>
    <br>
    <div>
        <form class="d-flex" th:action="@{|/software/${softwareAndReportDTO.id}|}" th:method="DELETE" th:if="${softwareAndReportDTO.uploader_name}==${#authentication.principal.user.username}">
            <input class="form-control me-2" type="hidden" aria-label="uploader_name" name="uploader_name" th:value="${softwareAndReportDTO.uploader_name}">
            <input class="form-control me-2" type="hidden" aria-label="uploader_name" name="first_name" th:value="${softwareAndReportDTO.first_name}">
            <button class="btn btn-outline-success" type="submit">시그니처삭제</button>
        </form>
    </div>
    <br>
    <div class="container">
        <table>
            <thead>
            <tr>
                <th>목적 분류</th>
            </tr>
            <thead>
            <tbody>
                <tr th:each="purpose: ${softwareAndReportDTO.purposeList}">
                    <td th:text="${purpose.purpose}"></td>
                    <td th:text="${purpose.checker_name}"></td>
                    <td th:text="${purpose.check_datetime}"></td>
                    <td>
                        <a th:href="@{|/software/${softwareAndReportDTO.id}/purpose/${purpose.id}|}">리포트 다운로드</a>  <!--/id/${purpose.id}/downloadpurpose-->
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <br>
    <div class="container">
        <table>
            <thead>
            <tr>
                <th>행위 분류</th>
            </tr>
            <thead>
            <tbody>
                <tr th:each="behavior: ${softwareAndReportDTO.behaviorList}">
                    <td th:text="${behavior.behavior}"></td>
                    <td th:text="${behavior.checker_name}"></td>
                    <td th:text="${behavior.check_datetime}"></td>
                    <td>
                        <a th:href="@{|/software/${softwareAndReportDTO.id}/behavior/${behavior.id}|}">리포트 다운로드</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <br>
    <div>
        <form th:action="@{|/software/${softwareAndReportDTO.id}/purpose|}" method="post" enctype="multipart/form-data">
            <input type="hidden" name="id" th:value="${softwareAndReportDTO.id}" />
            <label for="purpose">목적분류 :</label>
            <select name = "purpose" id="purpose">
                <option value = "downloader" selected>downloader</option>
                <option value = "dropper">dropper</option>
                <option value = "launcher">launcher</option>
                <option value = "adware">adware</option>
                <option value = "spyware">spyware</option>
                <option value = "ransomware">ransomware</option>
                <option value = "backdoor">backdoor</option>
                <option value = "exploit">exploit</option>
                <option value = "bot">bot</option>
                <option value = "scareware">scareware</option>
            </select>
            <input type="file" value="파일 선택" name="file"/>
            <button type="submit">제출</button>
        </form>
    </div>
    <br>
    <div>
        <form th:action="@{|/software/${softwareAndReportDTO.id}/behavior|}" method="post" enctype="multipart/form-data">
            <input type="hidden" name="id" th:value="${softwareAndReportDTO.id}" />
            <label for="behavior">행위분류 :</label>
            <select name = "behavior" id="behavior">
                <option value = "virus" selected>virus</option>
                <option value = "worm">worm</option>
                <option value = "trojan">trojan</option>
                <option value = "pup">pup</option>
            </select>
            <input type="file" value="파일 선택" name="file"/>
            <button type="submit">제출</button>
        </form>
    </div>
    <br>
    <button><a th:href="@{|/signature/api1/${signature}|}">api 리포트</a></button>
</div>
</body>
</html>